Le lock fonctionne car il est basé sur la version du document, toute modificication du lock entraine une modification
du document et c'est cela qui vous protège des mises à jour concurrentes

La gestion du lock est pas optimale non plus, il aurait été pas mal de remonté un conflit si 2 personnes veulent locker
le document